---
layout: post

title: 蒙特卡罗方法采样(Monte Carlo Simlation)
date: 2019-12-12 18:02:24.000000000 +09:00
---
### Sampling
&emsp;概率密度估计问题：给定统计样本集，如何估计产生这个样本集的随机变量概率密度函数；(常用方法：最大似然估计，最大后验估计等)<br>&emsp;逆问题:给定概率分布p(x)，如何让计算机生成满足这个概率分布的样本，这就是采样。<br>注：概率密度函数表示随机变量的输出值在某个确定的取值点附近的可能性的函数。

### 马尔科夫链及其平稳分布
&emsp;数学定义如下:<br>&emsp;    P(Xt+1=x|Xt,Xt−1,...)=P(Xt+1=x|Xt)<br>&emsp;也就是说在马尔科夫链上，体现的是状态空间的转换关系，下一个状态只决定于当前的状态。<br>&emsp;马尔科夫链定理：如果一个非周期马尔科夫链具有转移概率矩阵P，则它的任何两个状态是连通的，即不管初始状态是什么，最后都会收敛于相同的值。(连通表示两个状态之间可以通过有限次的迭代到达)

### MCMC采样算法
&emsp;Problem:For a given distribution p(x),to generate samples easily.<br>&emsp:Motivation:由于马尔科夫链可以收敛到平稳分布，如果构建一个转移矩阵为P的马尔科夫链，它的平稳分布正好是p(x),那么在收敛时候的取值就是p(x)的样本。<br>&emsp;基于马氏链的蒙特卡罗方法：<br>&emsp;细致平稳条件:<br>&emsp;如果如果非周期马尔科夫链的转移矩阵P和分布π(x)满足π(i)Pij=π(j)Pji for all i,j,则π(x)是马尔科夫链的平稳分布，上式被称为细致平稳条件(detailed balance condition)。直观上的一种理解就是，从i转移到j丢失的概率质量，会被从j转移到i的补偿回来，但是这两者通常是不相等的，所以在式子左边乘a(i,j),右边乘a(j,i),此时，就有转移状态Q，对应元素pij，达到细致平稳条件。<br>&emsp;上述Q存在的问题，当Q过小时，收敛速度过慢，可以通过等比例放大式子左右两边的转移状态，提高采样中的跳转接受率。

### Gibbs Sampling
&emsp;对于高维情形,由于接受率的存在，MCMC效率不高。针对二维情形分析：<br>&emsp;假设有一个概率分布p(x,y) ，考察x坐标相同的两个点A(x1,y1),B(x1,y2),可以发现：<br>
p(x1,y1)p(y2|x1)=p(x1)p(y1|x1)p(y2|x1)<br>
p(x1,y2)p(y1|x1)=p(x1)p(y2|x1)p(y1|x1)<br>所以得到<br>
p(x1,y1)p(y2|x1)=p(x1,y2)p(y1|x1)<br>即:
p(A)p(y2|x1)=p(B)p(y1|x1)<br>&emsp;根据上述推理，可以发现在x=x1这条平行于y轴的直线上，如果使用条件分布p(y|x1)做为任何两个点之间的转移概率，那么任何两个点之间的转移满足细致平稳条件。
同样的，如果我们在y=y1这条直线上任意取两个点，也满足细致平稳条件，则该二维空间上的马氏链将收敛到平稳分布p(x,y)。<br>&emsp;注：个人理解，该算法可以总结为，状态转移的过程中，只沿着坐标轴做转移。